<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>V√≤ng Quay May M·∫Øn - DAKA</title>

<style>
*{
  box-sizing:border-box;
  font-family:Arial, sans-serif;
}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#0f3d2e,#1b5e20,#2e7d32);
}

.game{
  width:380px;
  background:#fff;
  border-radius:28px;
  padding:25px 20px 30px;
  text-align:center;
  box-shadow:0 25px 50px rgba(0,0,0,.45);
}

.logo img{
  width:80px;
}

.logo h1{
  font-size:20px;
  margin:6px 0 12px;
  color:#1b5e20;
}

input{
  width:100%;
  padding:12px;
  border-radius:25px;
  border:1px solid #ccc;
  font-size:15px;
  text-align:center;
  margin:6px 0;
}

#wheel-box{
  position:relative;
  width:260px;
  height:260px;
  margin:20px auto;
}

.pointer{
  position:absolute;
  top:-18px;
  left:50%;
  transform:translateX(-50%);
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:24px solid #e53935;
  z-index:10;
}

#wheel{
  width:260px;
  height:260px;
  border-radius:50%;
  background:conic-gradient(
    #ff1744,
    #ff9100,
    #ffee58,
    #00e676,
    #00b0ff,
    #651fff,
    #ff1744
  );
  transition:transform 4s cubic-bezier(.17,.67,.19,1);
  box-shadow:
    inset 0 0 30px rgba(255,255,255,.6),
    inset 0 0 40px rgba(0,0,0,.25),
    0 15px 35px rgba(0,0,0,.45);
}

button{
  padding:14px 34px;
  border:none;
  border-radius:40px;
  font-size:16px;
  font-weight:bold;
  color:#fff;
  background:linear-gradient(45deg,#1b5e20,#66bb6a);
  cursor:pointer;
  margin:6px;
}

/* ·∫®N N√öT QU·∫¢N L√ù */
#exportBtn{
  display:none;
}

/* POPUP */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  justify-content:center;
  align-items:center;
}

.popup-box{
  background:#fff;
  width:300px;
  padding:30px;
  border-radius:25px;
  text-align:center;
}
</style>
</head>

<body>

<div class="game">

  <div class="logo">
    <img src="logo.png">
    <h1>DAKA COFFEE</h1>
  </div>

  <!-- KH√ÅCH -->
  <input id="phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">

  <div id="wheel-box">
    <div class="pointer"></div>
    <div id="wheel"></div>
  </div>

  <button onclick="spin()">QUAY NGAY</button>

  <hr style="margin:15px 0">

  <!-- CH·ª¶ QU√ÅN -->
  <input id="adminPass" placeholder="M·∫≠t kh·∫©u ch·ªß qu√°n">
  <button onclick="unlockAdmin()">M·ªû QU·∫¢N L√ù</button>
  <button id="exportBtn" onclick="exportExcel()">üìä XU·∫§T DANH S√ÅCH</button>

</div>

<div class="popup" id="popup">
  <div class="popup-box">
    <h3>üéâ CH√öC M·ª™NG üéâ</h3>
    <p id="result"></p>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<script>
let degree = 0;
const STORAGE = "DAKA_WINNERS";
const ADMIN_PASSWORD = "DAKA0974656346"; // üîê ƒê·ªîI M·∫¨T KH·∫®U T·∫†I ƒê√ÇY

const prizes = [
 "1 ly c√† ph√™ s·ªØa",
 "1 ly c√† ph√™ ƒëen",
 "1 ly b·∫°c x·ªâu",
 "1 ly cacao s·ªØa",
 "Gi·∫£m 10%",
 "Gi·∫£m 30%",
 "Mi·ªÖn ph√≠ 100%"
];

function spin(){
  const phone = document.getElementById("phone").value.trim();
  if(phone === ""){
    alert("Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i!");
    return;
  }

  let list = JSON.parse(localStorage.getItem(STORAGE) || "[]");
  if(list.find(x => x.phone === phone)){
    alert("S·ªë ƒëi·ªán tho·∫°i n√†y ƒë√£ quay r·ªìi!");
    return;
  }

  const index = Math.floor(Math.random() * prizes.length);
  degree += 360 * 6 + index * (360 / prizes.length);
  document.getElementById("wheel").style.transform = `rotate(${degree}deg)`;

  setTimeout(()=>{
    document.getElementById("result").innerText = "B·∫°n tr√∫ng: " + prizes[index];
    document.getElementById("popup").style.display = "flex";

    list.push({
      phone: phone,
      prize: prizes[index],
      time: new Date().toLocaleString()
    });

    localStorage.setItem(STORAGE, JSON.stringify(list));
  },4000);
}

function closePopup(){
  document.getElementById("popup").style.display = "none";
}

function unlockAdmin(){
  const pass = document.getElementById("adminPass").value;
  if(pass === ADMIN_PASSWORD){
    document.getElementById("exportBtn").style.display = "inline-block";
    alert("M·ªü quy·ªÅn qu·∫£n l√Ω th√†nh c√¥ng!");
  }else{
    alert("Sai m·∫≠t kh·∫©u!");
  }
}

function exportExcel(){
  let list = JSON.parse(localStorage.getItem(STORAGE) || "[]");
  if(list.length === 0){
    alert("Ch∆∞a c√≥ d·ªØ li·ªáu!");
    return;
  }

  let csv = "SƒêT,Ph·∫ßn th∆∞·ªüng,Th·ªùi gian\n";
  list.forEach(x=>{
    csv += `${x.phone},${x.prize},${x.time}\n`;
  });

  const blob = new Blob([csv], {type:"text/csv"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "danh_sach_trung_qua.csv";
  a.click();
}
</script>

</body>
</html>
